import { Component, OnInit } from "@angular/core";
import { FormBuilder, Validators } from "@angular/forms";
import { MatDialog } from "@angular/material";
import { ActivatedRoute, Router } from "@angular/router";
import { CenterClient, CenterReportDto, GetCenterDto } from "src/app/autogenerated/api";
import { CenterReportComponent } from "../center-report/center-report.component";

@Component({
  selector: "app-report",
  templateUrl: "./report.component.html",
  styleUrls: ["./report.component.css"],
})
export class ReportComponent implements OnInit {

  id: number;
  selectedCenter$: GetCenterDto;
  centerReport: CenterReportDto;
  
//   {
//     [key: string]: number;
// }; 

  constructor(
    private centerClient: CenterClient,
    private fb: FormBuilder,
    private route: ActivatedRoute,
    private router: Router,
    public dialog: MatDialog
  ) {}

  centerOptions$ = this.centerClient.listCenters();
  form = this.fb.group({
    centerId: ["", Validators.required],
  });

  ngOnInit() {

    // this.id=parseInt(this.route.snapshot.paramMap.get("id"));
    // this.centerClient.getCenterById(this.id).subscribe(data=>this.selectedCenter$=data);
  }

  openDialog(value): void {
    
    this.centerClient.getCenterSummary(value).subscribe((data) => {
      this.centerReport = data;
      const dialogRef = this.dialog.open(CenterReportComponent, {
        width: "250px",
        data: this.centerReport,
      });
      dialogRef.afterClosed().subscribe((result) => {
        console.log(`Dialog result: ${result}`);
      });
    });
  }
}
